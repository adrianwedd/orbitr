# Orbitr AI Backend - Production Environment Configuration
# Copy this file to .env.production and update with your production values

# ============================================================================
# CRITICAL SECURITY SETTINGS - MUST BE CONFIGURED FOR PRODUCTION
# ============================================================================

# Environment
ENVIRONMENT=production

# API Security
API_KEY=your_secure_api_key_minimum_32_characters_required_change_this
API_KEY_EXPIRY=1735689600  # Unix timestamp - set appropriate expiry date
REQUIRE_AUTH_IN_DEV=false

# ============================================================================
# CORS AND NETWORK SECURITY
# ============================================================================

# CORS Configuration - Replace with your actual frontend domains
CORS_ALLOWED_ORIGINS=https://yourdomain.com,https://www.yourdomain.com
TRUSTED_HOSTS=yourdomain.com,www.yourdomain.com

# ============================================================================
# RATE LIMITING CONFIGURATION
# ============================================================================

# Rate limits per minute per IP
GENERATION_RATE_LIMIT=5
CACHE_RATE_LIMIT=20
HEALTH_RATE_LIMIT=30
BATCH_RATE_LIMIT=2
CLEAR_CACHE_RATE_LIMIT=1
RATE_LIMIT_WINDOW=minute

# ============================================================================
# RESOURCE LIMITS
# ============================================================================

# Request and generation limits
MAX_REQUEST_SIZE=5242880  # 5MB for production
MAX_GENERATION_DURATION=3.0  # 3 seconds max
MAX_PROMPT_LENGTH=300
MAX_CONCURRENT_GENERATIONS=2
GENERATION_TIMEOUT=20

# Cache configuration
CACHE_MAX_SIZE_MB=500
CACHE_CLEANUP_INTERVAL=1800  # 30 minutes
ENABLE_CACHE_ENCRYPTION=true

# ============================================================================
# SECURITY HEADERS AND PROTECTION
# ============================================================================

# Security headers
ENABLE_SECURITY_HEADERS=true

# Content Security Policy - Customize based on your frontend needs
CSP_DEFAULT_SRC='self'
CSP_SCRIPT_SRC='self' 'unsafe-inline'
CSP_STYLE_SRC='self' 'unsafe-inline'
CSP_IMG_SRC='self' data: blob:
CSP_MEDIA_SRC='self' blob:
CSP_CONNECT_SRC='self'
CSP_FONT_SRC='self'

# ============================================================================
# AUTHENTICATION AND SESSION MANAGEMENT
# ============================================================================

# Session configuration
SESSION_TIMEOUT=1800  # 30 minutes
MAX_FAILED_ATTEMPTS=3
LOCKOUT_DURATION=600  # 10 minutes

# ============================================================================
# LOGGING AND MONITORING
# ============================================================================

# Security logging
ENABLE_SECURITY_LOGGING=true
SECURITY_LOG_LEVEL=WARNING
LOG_DIR=/var/log/orbitr
LOG_RETENTION_DAYS=90
SECURITY_LOG_FILE=security.log

# ============================================================================
# API KEY MANAGEMENT
# ============================================================================

# API key storage
API_KEYS_FILE=/etc/orbitr/api_keys.json
ENCRYPTION_KEY_FILE=/etc/orbitr/encryption.key

# ============================================================================
# SSL/TLS CONFIGURATION
# ============================================================================

# HTTPS enforcement
FORCE_HTTPS=true
HSTS_MAX_AGE=31536000  # 1 year
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=true

# ============================================================================
# DATABASE AND STORAGE (if applicable)
# ============================================================================

# Database configuration (add if implementing persistent storage)
# DATABASE_URL=postgresql://user:password@localhost/orbitr
# DATABASE_SSL_MODE=require

# ============================================================================
# EXTERNAL SERVICES
# ============================================================================

# AI Model configuration
MODEL_CACHE_DIR=/var/cache/orbitr/models
MODEL_LOAD_TIMEOUT=300  # 5 minutes

# ============================================================================
# PERFORMANCE AND SCALING
# ============================================================================

# Worker configuration
WORKERS=4
MAX_WORKERS=8
WORKER_TIMEOUT=120

# Memory limits
MAX_MEMORY_MB=4096
MODEL_MEMORY_LIMIT_MB=2048

# ============================================================================
# MONITORING AND ALERTING
# ============================================================================

# Health check configuration
HEALTH_CHECK_TIMEOUT=10
HEALTH_CHECK_INTERVAL=30

# Metrics and monitoring
ENABLE_METRICS=true
METRICS_PORT=9090
PROMETHEUS_METRICS=true

# Alert thresholds
ALERT_ERROR_RATE_THRESHOLD=0.05  # 5%
ALERT_RESPONSE_TIME_THRESHOLD=5000  # 5 seconds
ALERT_MEMORY_THRESHOLD=0.9  # 90%

# ============================================================================
# BACKUP AND RECOVERY
# ============================================================================

# Backup configuration
BACKUP_ENABLED=true
BACKUP_INTERVAL=86400  # Daily
BACKUP_RETENTION_DAYS=30
BACKUP_LOCATION=/var/backups/orbitr

# ============================================================================
# DEVELOPMENT OVERRIDES (for staging/testing)
# ============================================================================

# Set to true only for staging environments
DEBUG_MODE=false
DEVELOPMENT_FEATURES=false
MOCK_AI_GENERATION=false

# ============================================================================
# ADDITIONAL SECURITY CONFIGURATIONS
# ============================================================================

# IP Whitelist (optional - comma separated)
# ALLOWED_IPS=192.168.1.0/24,10.0.0.0/8

# Geographic restrictions (optional)
# BLOCKED_COUNTRIES=CN,RU

# User agent filtering
BLOCK_SUSPICIOUS_USER_AGENTS=true

# Request signing (for high-security environments)
REQUIRE_REQUEST_SIGNING=false
REQUEST_SIGNING_SECRET=your_request_signing_secret_key

# ============================================================================
# COMPLIANCE AND AUDITING
# ============================================================================

# GDPR compliance
GDPR_COMPLIANCE_MODE=true
DATA_RETENTION_DAYS=30
AUDIT_LOG_ENABLED=true

# SOC2 compliance
SOC2_COMPLIANCE_MODE=true
ACCESS_LOG_RETENTION_DAYS=365

# ============================================================================
# DOCKER AND CONTAINER CONFIGURATION
# ============================================================================

# Container security
RUN_AS_NON_ROOT=true
USER_ID=1000
GROUP_ID=1000

# Resource limits for containers
CONTAINER_MEMORY_LIMIT=4g
CONTAINER_CPU_LIMIT=2

# ============================================================================
# NOTES FOR PRODUCTION DEPLOYMENT
# ============================================================================

# 1. Change ALL default values, especially API_KEY
# 2. Use strong, unique passwords and keys (minimum 32 characters)
# 3. Configure proper SSL/TLS certificates
# 4. Set up log rotation and monitoring
# 5. Configure firewall rules to restrict access
# 6. Regular security updates and vulnerability scanning
# 7. Backup encryption keys securely
# 8. Test disaster recovery procedures
# 9. Configure proper DNS and load balancing
# 10. Set up health checks and monitoring alerts

# ============================================================================
# SECURITY CHECKLIST
# ============================================================================

# [ ] Changed default API_KEY
# [ ] Configured CORS_ALLOWED_ORIGINS for your domain
# [ ] Set appropriate rate limits
# [ ] Configured SSL/TLS certificates
# [ ] Set up log monitoring and alerting
# [ ] Configured firewall rules
# [ ] Set up regular backups
# [ ] Implemented monitoring and health checks
# [ ] Configured proper file permissions
# [ ] Set up intrusion detection
# [ ] Configured database security (if applicable)
# [ ] Set up vulnerability scanning
# [ ] Implemented incident response procedures